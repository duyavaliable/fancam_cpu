<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-Pop Fancam Generator</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Top Navigation -->
    <header class="top-nav">
        <div class="nav-left">
            <div class="logo">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
                </svg>
                <span>Fancam AI</span>
            </div>
            <span class="project-name">K-Pop Auto Tracking</span>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="main-container">
        <!-- Center Panel -->
        <main class="center-content">
            <!-- Upload Area -->
            <div class="upload-section" id="uploadSection">
                <div class="dropzone" id="dropzone">
                    <input type="file" id="videoInput" accept="video/*" hidden>
                    <label for="videoInput" class="dropzone-content">
                        <svg class="upload-icon" viewBox="0 0 24 24">
                            <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
                        </svg>
                        <p class="dropzone-text">Click to <span class="link-text">browse</span> your videos, or drag & drop files here</p>
                        <p class="dropzone-hint">Support: MP4, AVI, MOV, MKV (Max: 500MB)</p>
                    </label>
                </div>
            </div>

            <!-- Video Preview -->
            <div class="preview-section" id="previewSection" style="display:none;">
                <!-- ✅ NÚT XÓA VIDEO -->
                <button class="close-video-btn" id="closeVideoBtn" title="Remove video">
                    <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>

                <div class="video-wrapper">
                    <video id="videoPlayer" class="main-video" controls></video>
                    
                    <!-- Play Overlay -->
                    <div class="play-overlay" id="playOverlay">
                        <button class="play-btn-large">
                            <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                        </button>
                    </div>
                </div>

            </div>

            <!-- Detection Result (KHÔNG CÓ NÚT ĐÓNG) -->
            <div class="detection-result" id="detectionResult" style="display:none;">
                <div class="result-header">
                    <h3>Detection Result</h3>
                </div>
                <div class="result-content">
                    <img id="detectionImage" alt="Detection">
                    <div class="result-info" id="detectionInfo"></div>
                </div>
            </div>
        </main>

        <!-- Right Panel -->
        <aside class="sidebar-right">
            <div class="panel-header">
                <button class="panel-tab active" data-panel="tracking">Tracking</button>
            </div>

            <div class="panel-body">
                <!-- Tracking Settings -->
                <div class="settings-panel active" id="trackingPanel">
                    <!-- Target ID -->
                    <div class="setting-block">
                        <label class="setting-label">
                            <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                            Target Person ID
                        </label>
                        <input type="text" id="targetIdInput" class="input-box" placeholder="Enter ID (e.g., 1)">
                        <button class="btn-action" id="detectBtn">
                            <svg viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5z"/></svg>
                            Detect People
                        </button>
                    </div>

                    <!-- Reference Images -->
                    <div class="setting-block">
                        <label class="setting-label">Reference Images</label>
                        
                        <div class="upload-group">
                            <div class="upload-item">
                                <div class="upload-label-icon">
                                    <svg viewBox="0 0 24 24"><path d="M9 11.75c-.69 0-1.25.56-1.25 1.25s.56 1.25 1.25 1.25 1.25-.56 1.25-1.25-.56-1.25-1.25-1.25z"/></svg>
                                    <span>Face Images</span>
                                </div>
                                <input type="file" id="faceUpload" accept="image/*" multiple hidden>
                                <label for="faceUpload" class="btn-mini">
                                    <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                                    Add
                                </label>
                                <div class="file-preview" id="faceFilePreview"></div>
                            </div>

                            <div class="upload-item">
                                <div class="upload-label-icon">
                                    <svg viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01z"/></svg>
                                    <span>Outfit Images</span>
                                </div>
                                <input type="file" id="colorUpload" accept="image/*" multiple hidden>
                                <label for="colorUpload" class="btn-mini">
                                    <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                                    Add
                                </label>
                                <div class="file-preview" id="colorFilePreview"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Zoom Level -->
                    <div class="setting-block">
                        <label class="setting-label">Zoom Level</label>
                        <div class="slider-wrapper">
                            <input type="range" id="zoomSlider" min="1.0" max="4.0" step="0.1" value="1.0" class="range-slider">
                            <span class="range-value" id="zoomValue">1.0x</span>
                        </div>
                        <div class="preset-buttons">
                            <button class="preset-btn active" data-zoom="1.0">1.0x</button>
                            <button class="preset-btn" data-zoom="1.5">1.5x</button>
                            <button class="preset-btn" data-zoom="2.0">2.0x</button>
                            <button class="preset-btn" data-zoom="3.0">3.0x</button>
                        </div>
                    </div>

                    <!-- Generate Button -->
                    <button class="btn-generate" id="generateBtn">
                        <svg viewBox="0 0 24 24"><path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/></svg>
                        Generate Fancam
                    </button>
                </div>
            </div>
        </aside>
    </div>

    <!-- Processing Modal -->
    <div class="modal-overlay" id="processingModal" style="display:none;">
        <div class="modal-box">
            <div class="spinner-ring"></div>
            <h3>Processing Video...</h3>
            <p id="processingStatus">Initializing...</p>
            <div class="progress-track">
                <div class="progress-bar" id="progressBar"></div>
            </div>
        </div>
    </div>

    <!-- Result Modal -->
    <div class="modal-overlay" id="resultModal" style="display:none;">
        <div class="modal-box result-modal">
            <button class="modal-close-btn" id="closeResultBtn">✕</button>
            <div class="success-icon">
                <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
            </div>
            <h3>Fancam Generated!</h3>
            <video id="resultVideo" controls class="result-video"></video>
            <div class="modal-actions">
                <a class="btn-primary" id="downloadBtn" download>
                    <svg viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                </a>
                <button class="btn-secondary" id="createNewBtn">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                    </svg>
                    New Project
                </button>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Custom Confirm Dialog -->
    <div class="confirm-overlay" id="confirmDialog" style="display:none;">
        <div class="confirm-box">
            <div class="confirm-icon warning">
                <svg viewBox="0 0 24 24">
                    <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
                </svg>
            </div>
            <h3 id="confirmTitle">Confirm Action</h3>
            <p id="confirmMessage">Are you sure?</p>
            <div class="confirm-actions">
                <button class="btn-cancel" id="confirmCancel">Cancel</button>
                <button class="btn-confirm" id="confirmOk">Confirm</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>